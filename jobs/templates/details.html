{% extends 'base.html' %}
{% block title %}
<title>Job for {{ jobs.title }}</title>
{% endblock title %}

{% block content %}



{% include 'navbar.html' %}
<section class="morejobsearch" style="background-color: #f5f5f7; height: 100vh;">
    <div class="container" id="morejobsearch">

        <div class="row g-5">
            <!-- ============================================================ left part section ================================================== -->
            <div class="col-md-7 col-lg-8">

                <h3 class="mb-3" style="text-align: left;"> <img class="card-img-left example-card-img-responsive"
                        src="{{jobs.logo.url}}" width="200px" height="200px"> {{jobs.company_name}} </h3>
                <div class="table-responsive">
                    <table class="table table-sm" style="text-align: left;">
                        <tbody>
                            <tr>
                                <td colspan="2" class="fw-bold" style="text-align: left; font-size: 24px;">
                                    {{jobs.title}} </td>
                            </tr>
                            <tr>
                                <th>Description </th>
                                <td style="text-align: justify;"> {{jobs.description}} </td>
                            </tr>
                            <tr>
                                <th>Company </th>
                                <td style="text-align: justify;"> {{jobs.company_name}} </td>
                            </tr>
                            <tr>
                                <th>Website </th>
                                <td style="text-align: justify;"><a href="{{job.company_website}}">
                                        {{jobs.company_website}} </a> </td>
                            </tr>
                            <tr>
                                <th>Location </th>
                                <td style="text-align: justify;"> {{jobs.location}} </td>
                            </tr>
                            <tr>
                                <th>Salary </th>
                                <td style="text-align: justify;"> {{jobs.salary}} </td>
                            </tr>
                            <tr>
                                <th>Job Type </th>
                                <td style="text-align: justify;"> {{jobs.type|capfirst}} </td>
                            </tr>
                            <tr>
                                <th>Catagory </th>
                                <td style="text-align: justify;"> {{jobs.category}} </td>
                            </tr>
                            <tr>
                                <th>Posted On </th>
                                <td style="text-align: justify;"> {{jobs.created_at}} </td>
                            </tr>
                            <tr>
                                <th>Valid Till </th>
                                <td style="text-align: justify;"> {{jobs.application_valid}} </td>
                            </tr>
                            {% if request.user.is_authenticated %}
                            <tr>
                                {% if request.user == jobs.posted_by %}
                                <th>Action</th>
                                <td style="text-align: justify;"><button data-jobid="{{jobs.id}}"
                                        class="btn btn-danger btn-sm" data-bs-toggle="modal"
                                        data-bs-target="#exampleModal"><i class="bi bi-trash"></i> Delete</button>
                                </td>
                                {% endif %}
                                {% if not request.user.is_employer %}
                                <th>Action</th>
                                {% if applications %}
                                <td style="text-align: justify;"> You have already applied for this job. </td>

                                {% else %}
                                <td style="text-align: justify;"><a href="{% url 'jobs:apply_job' jobs.id %}"
                                        class="btn btn-secondary btn-sm"><i class="bi bi-link-45deg"></i>
                                        Apply</a>

                                </td>
                                {% endif %}
                                {% endif %}

                            </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ============================================================ right part section ================================================== -->

            {% include 'recommend.html' %}
        </div>
    </div>
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Delete Job</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Are You Sure?
                    <form id="delete-form" method="post" action="{% url 'jobs:delete_job' %}">{%csrf_token%}
                        <input type="text" name="jobid" id="_jobid" />
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
                    <button type="button" class="btn btn-danger btn-md" id="delete-button">Yes</button>

                </div>
            </div>
        </div>
    </div>
    </div>

</section>

<!-- ========================================= footer section ================================================== -->


{%endblock content%}

{% block script%}
{{ block.super }}
<script type="text/javascript">
    $(document).ready(function () {
        $.ajax({
            url: '/demo-for-ajax/',
            type: 'GET',
            dataType: 'json',
            success: function (res) {
                console.log(res);
            },
            error: function (res) {
                console.log(res);
            }
        })
        let modal = document.getElementById("exampleModal");
        modal.addEventListener("show.bs.modal", function (evt) {
            let btn = evt.relatedTarget;
            let jobid = btn.dataset.jobid;
            $("#_jobid").val(jobid);
        });

        $("#delete-button").click(function () {
            $("#delete-form").submit();
        });
    });

//    function handleurl(url){
//     url=document.getElementById("url")
//     window.open(url)
//    }
</script>
{% endblock script %}