
{% extends 'base.html' %}
{% load static %}
 {% block title %}
    <title>Job Lists</title>
    {% endblock title %}



{% block content %}

    {% if jobs %}
    <div class="container-fluid m-5 mt-2">
    <div class="row">
    <h1 class="mt-2">Job Listings</h1>   
    
            {% for job in jobs %}
       
          <div class="card flex-row col-4 m-3">
            <img class="card-img-left example-card-img-responsive mt-5" src="{{ job.logo.url }}"
                            width="150px" height="120px" />
                    <div class="card-body">

                    <h5 class="mb-1">{{ job.title }}</h5>
                    <p class="mb-1">{{ job.company_name }}</p>
                    <p class="mb-1">{{ job.description }}</p>
                    <p><small>{{ job.location }}</small></p>
                    <p><small>Valid Till: {{ job.application_valid }}</small></p>
                     <hr> 
                    <div>
                <a href="{% url 'jobs:job_detail' job.id %}" class="btn btn-info btn-sm"><span class="btn-label"><i class="bi bi-eye"></i></span>
                  View More
                </a>
                <a href="{% url 'jobs:edit_job' job.id %}" class="btn btn-primary btn-sm"><span class="btn-label"><i class="bi bi-pencil"></i></span>
                  Edit
                </a>
    <button data-jobid = "{{job.id}}" class = "btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#exampleModal"><span class="btn-label"><i class="bi bi-trash"></i></span> Delete</button>

                 
                </div>
                
              </div>
              </div>
            {% endfor %}
                    </div>
                    
             
              

    {% else %}
        <p>You have not posted any jobs yet.</p>
    {% endif %}



<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
   <div class="modal-dialog">
     <div class="modal-content">
       <div class="modal-header">
         <h1 class="modal-title fs-5" id="exampleModalLabel">Delete Job</h1>
         <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
       </div>
       <div class="modal-body">
           Are You Sure?
           <form id="delete-form" method="post" action="{% url 'jobs:delete_job' %}">{%csrf_token%}
                   <input type="hidden" name="jobid" id="_jobid" />
           </form>
       </div>
       <div class="modal-footer">
         <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
         <button type="button" class="btn btn-danger btn-md" id="delete-button" >Yes</button>
       
   </div>
 </div>
        </div>
                </div>
                </div>
                    
{% endblock %}

{% block script%}
{{ block.super }}
<script type="text/javascript">
   $(document).ready(function(){
       $.ajax({
           url:'/demo-for-ajax/',
           type:'GET',
           dataType: 'json',
           success: function(res){
               console.log(res);
           },
           error: function(res) {
               console.log(res);
           }
       })
       let modal = document.getElementById("exampleModal");
       modal.addEventListener("show.bs.modal",function(evt){
           let btn = evt.relatedTarget;
           let jobid = btn.dataset.jobid;
           $("#_jobid").val(jobid);
       });

       $("#delete-button").click(function(){
           $("#delete-form").submit();
       });
   });
</script>
{% endblock script %}
